<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta name="Content-Type" content="text/html; charset=UTF-8" />
<title>Documentation by YARD 0.4.0</title>
<link rel="stylesheet" href="css/style.css" type="text/css" media="screen" charset="utf-8" />
<link rel="stylesheet" href="css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  relpath = '';
  if (relpath != '') relpath += '/';
</script>
<script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>
<script type="text/javascript" charset="utf-8" src="js/app.js"></script>

  </head>
  <body>
    <div id="header">
      <div id="menu">
  
    <a title="Index" href="_index.html">Index</a> &raquo; 
    <span class="title">File: README</span>
  
</div>

      <div id="search">
  <a id="class_list_link" href="#">Namespace List</a>
  <a id="method_list_link" href="#">Method List</a>
  <a id ="file_list_link" href="#">File List</a>
</div>

      <div class="clear"></div>
    </div>
    
    <iframe id="search_frame"></iframe>
    
    <div id="content"><div id='filecontents'><h1>Tropo Web API Ruby Library</h1>
<p>
A Ruby library for interaction with the Tropo Web API using JSON.
</p>
<h2>Tropo Web API Overview</h2>
<p>
The Tropo Remote API provides a RESTful JSON API for controlling realtime
communications applications from your own web servers.
</p>
<h2>Requirements</h2>
<ul>
<li>Ruby v1.8.6+ or JRuby v1.4.0+

</li>
<li>RubyGems

</li>
</ul>
<h2>Installation</h2>
<pre class="code">
  $ <span class='sudo identifier id'>sudo</span> <span class='gem identifier id'>gem</span> <span class='install identifier id'>install</span> <span class='tropo identifier id'>tropo</span><span class='minus op'>-</span><span class='webapi identifier id'>webapi</span><span class='minus op'>-</span><span class='ruby identifier id'>ruby</span>
</pre>
<p>
Optional, if you would like to use with Sinatra:
</p>
<pre class="code">
  $ <span class='sudo identifier id'>sudo</span> <span class='gem identifier id'>gem</span> <span class='install identifier id'>install</span> <span class='sinatra identifier id'>sinatra</span>
</pre>
<h2>Generate Documentation</h2>
<h3>Developer</h3>
<pre class="code">
  $ <span class='gemserver identifier id'>gemserver</span>
</pre>
<h3>Project Developer</h3>
<pre class="code">
  $ <span class='sudo identifier id'>sudo</span> <span class='gem identifier id'>gem</span> <span class='install identifier id'>install</span> <span class='yardoc identifier id'>yardoc</span>
</pre>
<p>
From within the project:
</p>
<pre class="code">
  $ <span class='yardoc identifier id'>yardoc</span>
</pre>
<h2>Usage</h2>
<pre class="code">
  <span class='require identifier id'>require</span> <span class='string val'>'rubygems'</span>
  <span class='require identifier id'>require</span> <span class='string val'>'tropo-webapi-ruby'</span>

  <span class='comment val'># Will return the properly formatted JSON to pass to Tropo</span>
  <span class='response identifier id'>response</span> <span class='assign token'>=</span> <span class='Tropo constant id'>Tropo</span><span class='colon2 op'>::</span><span class='Generator constant id'>Generator</span><span class='dot token'>.</span><span class='ask identifier id'>ask</span><span class='lparen token'>(</span><span class='lbrace token'>{</span> <span class='symbol val'>:say</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'Hello world!'</span> <span class='rbrace token'>}</span><span class='rparen token'>)</span>

  <span class='comment val'># Will return a Ruby Hash, with some transformations, from the JSON string received from Tropo</span>
  <span class='response identifier id'>response</span> <span class='assign token'>=</span> <span class='Tropo constant id'>Tropo</span><span class='colon2 op'>::</span><span class='Generator constant id'>Generator</span><span class='dot token'>.</span><span class='parse identifier id'>parse</span><span class='lparen token'>(</span><span class='json_string identifier id'>json_string</span><span class='rparen token'>)</span>

  <span class='comment val'># Will provide instance variables that will allow you to easily reference session type</span>
  <span class='tropo identifier id'>tropo</span> <span class='assign token'>=</span> <span class='Tropo constant id'>Tropo</span><span class='colon2 op'>::</span><span class='Generator constant id'>Generator</span><span class='dot token'>.</span><span class='new identifier id'>new</span>
  <span class='response identifier id'>response</span> <span class='assign token'>=</span> <span class='tropo identifier id'>tropo</span><span class='dot token'>.</span><span class='parse identifier id'>parse</span><span class='lparen token'>(</span><span class='json_string identifier id'>json_string</span><span class='rparen token'>)</span>
  <span class='p identifier id'>p</span> <span class='string val'>'Hey, this is a voice session!'</span> <span class='if if_mod kw'>if</span> <span class='tropo identifier id'>tropo</span><span class='dot token'>.</span><span class='voice_session identifier id'>voice_session</span>
  <span class='p identifier id'>p</span> <span class='string val'>'Hey, this is a text messaging session!'</span> <span class='if if_mod kw'>if</span> <span class='tropo identifier id'>tropo</span><span class='dot token'>.</span><span class='text_session identifier id'>text_session</span>
</pre>
<h2>Examples</h2>
<h3>Sinatra</h3>
<p>
Using the great RESTful Web Services framework Sinatra for Ruby.
</p>
<h4>Hello World</h4>
<pre class="code">
  <span class='require identifier id'>require</span> <span class='string val'>'rubygems'</span>
  <span class='require identifier id'>require</span> <span class='string val'>'sinatra'</span>
  <span class='require identifier id'>require</span> <span class='string val'>'tropo-webapi-ruby'</span>

  <span class='post identifier id'>post</span> <span class='string val'>'/helloworld.json'</span> <span class='do do kw'>do</span>
    <span class='Tropo constant id'>Tropo</span><span class='colon2 op'>::</span><span class='Generator constant id'>Generator</span><span class='dot token'>.</span><span class='say identifier id'>say</span> <span class='string val'>'Hello World!'</span>
  <span class='end end kw'>end</span>

  <span class='post identifier id'>post</span> <span class='string val'>'/helloworld_block.json'</span> <span class='do do kw'>do</span>
    <span class='tropo identifier id'>tropo</span> <span class='assign token'>=</span> <span class='Tropo constant id'>Tropo</span><span class='colon2 op'>::</span><span class='Generator constant id'>Generator</span><span class='dot token'>.</span><span class='new identifier id'>new</span> <span class='do do kw'>do</span>
      <span class='say identifier id'>say</span> <span class='string val'>'Hello World!'</span>
    <span class='end end kw'>end</span>
    <span class='tropo identifier id'>tropo</span><span class='dot token'>.</span><span class='response identifier id'>response</span>
  <span class='end end kw'>end</span>

  <span class='post identifier id'>post</span> <span class='string val'>'/helloworld_twice.json'</span> <span class='do do kw'>do</span>
    <span class='tropo identifier id'>tropo</span> <span class='assign token'>=</span> <span class='Tropo constant id'>Tropo</span><span class='colon2 op'>::</span><span class='Generator constant id'>Generator</span><span class='dot token'>.</span><span class='new identifier id'>new</span>
    <span class='tropo identifier id'>tropo</span><span class='dot token'>.</span><span class='say identifier id'>say</span> <span class='string val'>'Hello World!'</span>
    <span class='tropo identifier id'>tropo</span><span class='dot token'>.</span><span class='say identifier id'>say</span> <span class='string val'>'Hello again.'</span>
    <span class='tropo identifier id'>tropo</span><span class='dot token'>.</span><span class='response identifier id'>response</span>
  <span class='end end kw'>end</span>
</pre>
<h4>Getting Session Information</h4>
<pre class="code">
  <span class='comment val'># Produces a Ruby hash:</span>
  <span class='comment val'>#</span>
  <span class='comment val'># { :session =&gt;</span>
  <span class='comment val'>#   { :timestamp    =&gt; Tue Jan 19 18:27:46 -0500 2010,</span>
  <span class='comment val'>#     :user_type    =&gt;&quot;HUMAN&quot;,</span>
  <span class='comment val'>#     :initial_text =&gt; nil,</span>
  <span class='comment val'>#     :account_id   =&gt;&quot;0&quot;,</span>
  <span class='comment val'>#     :headers      =&gt; [{ &quot;value&quot; =&gt; &quot;70&quot;, &quot;key&quot;=&gt;&quot;Max-Forwards&quot; },</span>
  <span class='comment val'>#                       { &quot;value&quot; =&gt; &quot;385&quot;, &quot;key&quot;=&gt;&quot;Content-Length&quot; },</span>
  <span class='comment val'>#                       { &quot;value&quot; =&gt; &quot;&lt;sip:127.0.0.1:49152&gt;&quot;, &quot;key&quot;=&gt;&quot;Contact&quot; },</span>
  <span class='comment val'>#                       { &quot;value&quot; =&gt; &quot;replaces&quot;, &quot;key&quot;=&gt;&quot;Supported&quot; },</span>
  <span class='comment val'>#                       { &quot;value&quot; =&gt; &quot;&lt;sip:sample.json@localhost:5555&gt;&quot;, &quot;key&quot;=&gt;&quot;To&quot; },</span>
  <span class='comment val'>#                       { &quot;value&quot; =&gt; &quot;1 INVITE&quot;, &quot;key&quot;=&gt;&quot;CSeq&quot; },</span>
  <span class='comment val'>#                       { &quot;value&quot; =&gt; &quot;SJphone-M/1.65.382f (SJ Labs)&quot;, &quot;key&quot;=&gt;&quot;User-Agent&quot; },</span>
  <span class='comment val'>#                       { &quot;value&quot; =&gt; &quot;SIP/2.0/UDP 127.0.0.1:49152;branch=z9000000a9;rport=49152&quot;, &quot;key&quot;=&gt;&quot;Via&quot; },</span>
  <span class='comment val'>#                       { &quot;value&quot; =&gt; &quot;3FA7C70A1DD211B286B7A583D7B46DDD0xac106207&quot;, &quot;key&quot;=&gt;&quot;Call-ID&quot; },</span>
  <span class='comment val'>#                       { &quot;value&quot; =&gt; &quot;application/sdp&quot;, &quot;key&quot;=&gt;&quot;Content-Type&quot; },</span>
  <span class='comment val'>#                       { &quot;value&quot; =&gt; &quot;unknown &lt;sip:127.0.0.1:49152&gt;;tag=750b1b1648e9c876&quot;, &quot;key&quot;=&gt;&quot;From&quot; }],</span>
  <span class='comment val'>#     :id            =&gt; &quot;3FA7C70A1DD211B286B7A583D7B46DDD0xac106207&quot;,</span>
  <span class='comment val'>#     :to            =&gt; { :network =&gt; &quot;PSTN&quot;,</span>
  <span class='comment val'>#                         :channel =&gt; &quot;VOICE&quot;,</span>
  <span class='comment val'>#                         :name    =&gt; &quot;unknown&quot;,</span>
  <span class='comment val'>#                         :id      =&gt; &quot;sample.json&quot;},</span>
  <span class='comment val'>#     :from          =&gt; { :network =&gt; &quot;PSTN&quot;,</span>
  <span class='comment val'>#                         :channel =&gt; &quot;VOICE&quot;,</span>
  <span class='comment val'>#                         :name    =&gt; &quot;unknown&quot;,</span>
  <span class='comment val'>#                         :id      =&gt; &quot;unknown&quot;}}}</span>
  <span class='comment val'>#</span>
  <span class='post identifier id'>post</span> <span class='string val'>'/start_session.json'</span> <span class='do do kw'>do</span>
    <span class='tropo_session identifier id'>tropo_session</span> <span class='assign token'>=</span> <span class='Tropo constant id'>Tropo</span><span class='colon2 op'>::</span><span class='Generator constant id'>Generator</span><span class='dot token'>.</span><span class='parse identifier id'>parse</span> <span class='request identifier id'>request</span><span class='dot token'>.</span><span class='env identifier id'>env</span><span class='lbrack token'>[</span><span class='string val'>&quot;rack.input&quot;</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='read identifier id'>read</span>
    <span class='p identifier id'>p</span> <span class='tropo_session identifier id'>tropo_session</span>
  <span class='end end kw'>end</span>
</pre>
<h4>Asking for input and receiving the response, or catching a hangup</h4>
<pre class="code">
  <span class='post identifier id'>post</span> <span class='string val'>'/ask.json'</span> <span class='do do kw'>do</span>
    <span class='tropo identifier id'>tropo</span> <span class='assign token'>=</span> <span class='Tropo constant id'>Tropo</span><span class='colon2 op'>::</span><span class='Generator constant id'>Generator</span><span class='dot token'>.</span><span class='new identifier id'>new</span> <span class='do do kw'>do</span>
              <span class='on identifier id'>on</span> <span class='symbol val'>:event</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'hangup'</span><span class='comma token'>,</span> <span class='symbol val'>:next</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'/hangup.json'</span>
              <span class='on identifier id'>on</span> <span class='symbol val'>:event</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'continue'</span><span class='comma token'>,</span> <span class='symbol val'>:next</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'/answer.json'</span>
              <span class='ask identifier id'>ask</span><span class='lparen token'>(</span><span class='lbrace token'>{</span> <span class='symbol val'>:name</span>    <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'account_number'</span><span class='comma token'>,</span>
                    <span class='symbol val'>:bargein</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'true'</span><span class='comma token'>,</span>
                    <span class='symbol val'>:timeout</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='integer val'>30</span><span class='comma token'>,</span>
                    <span class='symbol val'>:require</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'true'</span> <span class='rbrace token'>}</span><span class='rparen token'>)</span> <span class='do do kw'>do</span>
                      <span class='say identifier id'>say</span>     <span class='symbol val'>:value</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'Please say your account number'</span>
                      <span class='choices identifier id'>choices</span> <span class='symbol val'>:value</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'[5 DIGITS]'</span>
                    <span class='end end kw'>end</span>
              <span class='end end kw'>end</span>
    <span class='tropo identifier id'>tropo</span><span class='dot token'>.</span><span class='response identifier id'>response</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># Produces a Ruby hash, if the user gives a response before hanging up:</span>
  <span class='comment val'>#</span>
  <span class='comment val'># { :result =&gt;</span>
  <span class='comment val'>#   { :actions          =&gt; { :attempts       =&gt; 1,</span>
  <span class='comment val'>#                            :disposition    =&gt; &quot;SUCCESS&quot;,</span>
  <span class='comment val'>#                            :interpretation =&gt; &quot;12345&quot;,</span>
  <span class='comment val'>#                            :confidence     =&gt; 100,</span>
  <span class='comment val'>#                            :name           =&gt; &quot;account_number&quot;,</span>
  <span class='comment val'>#                            :utterance      =&gt; &quot;1 2 3 4 5&quot; },</span>
  <span class='comment val'>#     :session_duration =&gt; 3,</span>
  <span class='comment val'>#     :error            =&gt; nil,</span>
  <span class='comment val'>#     :sequence         =&gt; 1,</span>
  <span class='comment val'>#     :session_id       =&gt; &quot;5325C262-1DD2-11B2-8F5B-C16F64C1D62E@127.0.0.1&quot;,</span>
  <span class='comment val'>#     :state            =&gt; &quot;ANSWERED&quot;,</span>
  <span class='comment val'>#     :complete         =&gt; true } }</span>
  <span class='comment val'>#</span>
  <span class='post identifier id'>post</span> <span class='string val'>'/answer.json'</span> <span class='do do kw'>do</span>
    <span class='tropo_event identifier id'>tropo_event</span> <span class='assign token'>=</span> <span class='Tropo constant id'>Tropo</span><span class='colon2 op'>::</span><span class='Generator constant id'>Generator</span><span class='dot token'>.</span><span class='parse identifier id'>parse</span> <span class='request identifier id'>request</span><span class='dot token'>.</span><span class='env identifier id'>env</span><span class='lbrack token'>[</span><span class='string val'>&quot;rack.input&quot;</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='read identifier id'>read</span>
    <span class='p identifier id'>p</span> <span class='tropo_event identifier id'>tropo_event</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># Produces a Ruby hash, if the user hangs up before giving a reponse</span>
  <span class='comment val'># { :result =&gt;</span>
  <span class='comment val'>#   { :actions          =&gt; {},</span>
  <span class='comment val'>#     :session_duration =&gt; 1,</span>
  <span class='comment val'>#     :error            =&gt; nil,</span>
  <span class='comment val'>#     :sequence         =&gt; 1,</span>
  <span class='comment val'>#     :session_id       =&gt; &quot;812BEF50-1DD2-11B2-8F5B-C16F64C1D62E@127.0.0.1&quot;,</span>
  <span class='comment val'>#     :state            =&gt; &quot;DISCONNECTED&quot;,</span>
  <span class='comment val'>#     :complete         =&gt; true } }</span>
  <span class='comment val'>#</span>
  <span class='post identifier id'>post</span> <span class='string val'>'/hangup.json'</span> <span class='do do kw'>do</span>
    <span class='tropo_event identifier id'>tropo_event</span> <span class='assign token'>=</span> <span class='Tropo constant id'>Tropo</span><span class='colon2 op'>::</span><span class='Generator constant id'>Generator</span><span class='dot token'>.</span><span class='parse identifier id'>parse</span> <span class='request identifier id'>request</span><span class='dot token'>.</span><span class='env identifier id'>env</span><span class='lbrack token'>[</span><span class='string val'>&quot;rack.input&quot;</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='read identifier id'>read</span>
    <span class='p identifier id'>p</span> <span class='tropo_event identifier id'>tropo_event</span>
  <span class='end end kw'>end</span>
</pre>
<h4>Redirect a call before answering</h4>
<pre class="code">
  <span class='comment val'># A redirect method</span>
  <span class='post identifier id'>post</span> <span class='string val'>'/redirect.json'</span> <span class='do do kw'>do</span>
    <span class='Tropo constant id'>Tropo</span><span class='colon2 op'>::</span><span class='Generator constant id'>Generator</span><span class='dot token'>.</span><span class='redirect identifier id'>redirect</span><span class='lparen token'>(</span><span class='lbrace token'>{</span> <span class='symbol val'>:to</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'sip:1234'</span><span class='comma token'>,</span> <span class='symbol val'>:from</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'4155551212'</span> <span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
</pre>
<h4>Reject a call before answering</h4>
<pre class="code">
  <span class='comment val'># A reject method</span>
  <span class='post identifier id'>post</span> <span class='string val'>'/reject.json'</span> <span class='do do kw'>do</span>
    <span class='Tropo constant id'>Tropo</span><span class='colon2 op'>::</span><span class='Generator constant id'>Generator</span><span class='dot token'>.</span><span class='reject identifier id'>reject</span>
  <span class='end end kw'>end</span>
</pre>
<h3>Additional Examples</h3>
<p>
May be found by checking out the project from Github, and then looking in
$PROJECT_HOME/examples and $PROJECT_HOME/spec/tropo-webapi-ruby_spec.rb.
</p>
<h2>Copyright</h2>
<p>
Copyright &#169; 2010 Voxeo, Corporation. See LICENSE for details.
</p>
</div></div>
    
    <div id="footer">
  Generated on Thu Jan 21 10:38:34 2010 by 
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool">yard</a>
  0.4.0 (ruby-1.8.7).
</div>

  </body>
</html>